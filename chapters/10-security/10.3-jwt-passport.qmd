# 10.3 æŠ¤ç…§ï¼šJWTæ— çŠ¶æ€è®¤è¯

> "å¥½çš„å‡­è¯ï¼Œè®©ä½ ä¸€æ¬¡ç™»å½•ï¼Œå¤„å¤„é€šè¡Œã€‚" â€”â€” JWTçš„æ‰¿è¯º

## æœ¬èŠ‚å±æœºï¼šæ¯æ¬¡æ•²é—¨éƒ½è¦é‡æ–°éªŒè¯èº«ä»½ï¼Ÿ

åœ¨ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬æˆåŠŸå®ç°äº†ç™»å½•åŠŸèƒ½ã€‚ç”¨æˆ·æäº¤ç”¨æˆ·åå’Œå¯†ç ï¼Œç³»ç»ŸéªŒè¯åè¿”å›"ç™»å½•æˆåŠŸ"ã€‚

ä½†è¿™é‡Œæœ‰ä¸ªè‡´å‘½çš„é—®é¢˜ï¼š**è¿™ä¸ª"æˆåŠŸ"åªç»´æŒäº†ä¸€ç¬é—´ã€‚**

æƒ³è±¡ä½ å»æ”¿åºœåŠäº‹ï¼š

1.  ä½ åœ¨Açª—å£åŠå®Œä¸€ä»¶äº‹ï¼Œå·¥ä½œäººå‘˜è¯´"å¥½çš„ï¼Œæ‚¨çš„èº«ä»½éªŒè¯é€šè¿‡äº†"ã€‚
2.  ä½ èµ°åˆ°Bçª—å£åŠä¸‹ä¸€ä»¶äº‹ï¼Œå·¥ä½œäººå‘˜è¯´ï¼š"å…ˆç”Ÿï¼Œè¯·å‡ºç¤ºæ‚¨çš„èº«ä»½è¯ã€‚"
3.  ä½ å»Cçª—å£ã€Dçª—å£...æ¯æ¬¡éƒ½è¦é‡æ–°éªŒè¯èº«ä»½ã€‚

è¿™å°±æ˜¯æˆ‘ä»¬å½“å‰çš„ç³»ç»ŸçŠ¶æ€ã€‚æ¯æ¬¡ç”¨æˆ·è®¿é—®`/api/playlists`ã€`/api/songs`ç­‰å—ä¿æŠ¤æ¥å£æ—¶ï¼Œéƒ½éœ€è¦é‡æ–°å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚è¿™æ˜¾ç„¶æ˜¯è’è°¬çš„ï¼š

*   **ç”¨æˆ·ä½“éªŒæå·®**ï¼šæ²¡äººæ„¿æ„æ¯ä¸ªæ“ä½œéƒ½è¾“å…¥å¯†ç ã€‚
*   **å®‰å…¨é£é™©**ï¼šå¯†ç åœ¨ç½‘ç»œä¸­é¢‘ç¹ä¼ è¾“ï¼Œå¢åŠ è¢«æˆªè·çš„é£é™©ã€‚
*   **æ€§èƒ½ä½ä¸‹**ï¼šæ¯æ¬¡è¯·æ±‚éƒ½è¦æŸ¥æ•°æ®åº“éªŒè¯å¯†ç ï¼Œæ•ˆç‡ä½ã€‚

**æˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼šç”¨æˆ·ç™»å½•ä¸€æ¬¡åï¼Œè·å¾—ä¸€ä¸ª"é€šè¡Œè¯"ï¼Œå‡­è¿™ä¸ªé€šè¡Œè¯åœ¨ä¸€æ®µæ—¶é—´å†…ï¼ˆå¦‚24å°æ—¶ï¼‰è‡ªåŠ¨é€šè¿‡æ‰€æœ‰å®‰æ£€ï¼Œæ— éœ€é‡å¤éªŒè¯èº«ä»½ã€‚**

## æœ¬èŠ‚é¡¿æ‚Ÿï¼šJWTâ€”â€”å¯éªŒè¯çš„æ•°å­—æŠ¤ç…§

**JWT (JSON Web Token)** å°±æ˜¯è¿™å¼ "æ•°å­—æŠ¤ç…§"ã€‚å®ƒæ˜¯ä¸€ä¸ªè‡ªåŒ…å«çš„ã€å¯éªŒè¯çš„å­—ç¬¦ä¸²ï¼ŒåŒ…å«äº†ï¼š

*   **ç”¨æˆ·æ˜¯è°**ï¼ˆä¾‹å¦‚ï¼šusername = "vibecoder"ï¼‰
*   **æŠ¤ç…§æœ‰æ•ˆæœŸ**ï¼ˆä¾‹å¦‚ï¼š24å°æ—¶åè¿‡æœŸï¼‰
*   **é˜²ä¼ªç­¾å**ï¼ˆåªæœ‰æœåŠ¡å™¨èƒ½ç”Ÿæˆå’ŒéªŒè¯ï¼‰

### JWTçš„ç»“æ„ï¼šä¸‰æ®µå¼é˜²ä¼ªè¯ä»¶

ä¸€ä¸ªJWTé•¿è¿™æ ·ï¼š

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ2aWJlY29kZXIiLCJleHAiOjE3MDAw...KziYm9haTvVJ0
```

å®ƒç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼ˆç”¨`.åˆ†éš”`ï¼‰ï¼š

#### 1. Headerï¼ˆè¯ä»¶ç±»å‹ï¼‰
```json
{
  "alg": "HS256",  // ä½¿ç”¨çš„ç­¾åç®—æ³•
  "typ": "JWT"     // ä»¤ç‰Œç±»å‹
}
```
Base64ç¼–ç åï¼š`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9`

#### 2. Payloadï¼ˆä¸ªäººä¿¡æ¯ï¼‰
```json
{
  "sub": "vibecoder",           // subjectï¼šç”¨æˆ·å
  "iat": 1699900000,            // issued atï¼šç­¾å‘æ—¶é—´
  "exp": 1699986400             // expirationï¼šè¿‡æœŸæ—¶é—´ï¼ˆ24å°æ—¶åï¼‰
}
```
Base64ç¼–ç åï¼š`eyJzdWIiOiJ2aWJlY29kZXIiLCJleHAiOjE3MDAw...`

#### 3. Signatureï¼ˆé˜²ä¼ªå°ç« ï¼‰
```
HMACSHA256(
  base64(header) + "." + base64(payload),
  secret_key  // åªæœ‰æœåŠ¡å™¨çŸ¥é“çš„å¯†é’¥
)
```

**å…³é”®ç‚¹**ï¼šä»»ä½•äººéƒ½å¯ä»¥**è¯»å–**JWTçš„å†…å®¹ï¼ˆå› ä¸ºåªæ˜¯Base64ç¼–ç ï¼Œä¸æ˜¯åŠ å¯†ï¼‰ã€‚ä½†åªæœ‰æ‹¥æœ‰å¯†é’¥çš„æœåŠ¡å™¨æ‰èƒ½**ç”Ÿæˆå’ŒéªŒè¯**ç­¾åã€‚

**æ¯”å–»**ï¼šå°±åƒæŠ¤ç…§ä¸Šçš„é˜²ä¼ªæ°´å°ã€‚ä½ å¯ä»¥çœ‹åˆ°æŠ¤ç…§ä¸Šçš„æ‰€æœ‰ä¿¡æ¯ï¼ˆå§“åã€å›½ç±ã€ç…§ç‰‡ï¼‰ï¼Œä½†ä½ æ— æ³•ä¼ªé€ é‚£ä¸ªåªæœ‰æ”¿åºœæ‰èƒ½åˆ¶ä½œçš„é˜²ä¼ªæ°´å°ã€‚

### JWT æ„é€ æµç¨‹å›¾

```{mermaid}
graph LR
    subgraph Inputs["è¾“å…¥éƒ¨åˆ†"]
        H["Header (ç®—æ³•)"]
        P["Payload (æ•°æ®)"]
        S["Secret Key (å¯†é’¥)"]
    end
    
    H -->|Base64| B1["Encoded Header"]
    P -->|Base64| B2["Encoded Payload"]
    
    B1 --> C{"æ‹¼æ¥ (.)"}
    B2 --> C
    C -->|Header.Payload| M["å¾…ç­¾åå­—ç¬¦ä¸²"]
    
    M -->|HMACSHA256| Sig["Signature (ç­¾å)"]
    S -->|å‚ä¸è¿ç®—| Sig
    
    B1 --> Final["JWT Token"]
    B2 --> Final
    Sig --> Final
    
    style Final fill:#f9f,stroke:#333,stroke-width:2px
```

### JWT vs Sessionï¼šä¸ºä»€ä¹ˆé€‰æ‹©æ— çŠ¶æ€ï¼Ÿ

| ç‰¹æ€§ | Sessionï¼ˆæœ‰çŠ¶æ€ï¼‰ | JWTï¼ˆæ— çŠ¶æ€ï¼‰ |
|------|------------------|--------------|
| **å­˜å‚¨ä½ç½®** | æœåŠ¡å™¨å†…å­˜/Redis | å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ |
| **å¯æ‰©å±•æ€§** | éœ€è¦Sessionå…±äº«æœºåˆ¶ | å¤©ç„¶æ”¯æŒå¤šæœåŠ¡å™¨ |
| **ç½‘ç»œä¼ è¾“** | åªä¼ é€’Session IDï¼ˆå°ï¼‰ | æ¯æ¬¡éƒ½ä¼ é€’å®Œæ•´Tokenï¼ˆç•¥å¤§ï¼‰ |
| **æ³¨é”€æœºåˆ¶** | ç›´æ¥åˆ é™¤Session | éœ€è¦é»‘åå•æœºåˆ¶ï¼ˆå¤æ‚ï¼‰ |
| **é€‚ç”¨åœºæ™¯** | ä¼ ç»ŸWebåº”ç”¨ | REST APIã€å¾®æœåŠ¡ |

å¯¹äºæˆ‘ä»¬çš„REST APIï¼ŒJWTæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚

---

## ç¬¬ä¸€æ­¥ï¼šå¼•å…¥JJWTåº“

åœ¨`gradle/libs.versions.toml`ä¸­æ·»åŠ ï¼š

```toml
[versions]
jjwt = "0.12.6"

[libraries]
jjwt-api = { module = "io.jsonwebtoken:jjwt-api", version.ref = "jjwt" }
jjwt-impl = { module = "io.jsonwebtoken:jjwt-impl", version.ref = "jjwt" }
jjwt-jackson = { module = "io.jsonwebtoken:jjwt-jackson", version.ref = "jjwt" }
```

åœ¨`build.gradle.kts`ä¸­æ·»åŠ ï¼š

```kotlin
dependencies {
    // ... å…¶ä»–ä¾èµ–
    implementation(libs.jjwt.api)
    runtimeOnly(libs.jjwt.impl)
    runtimeOnly(libs.jjwt.jackson)
}
```

---

## ç¬¬äºŒæ­¥ï¼šå®ç°JwtServiceï¼ˆç­¾å‘å’ŒéªŒè¯æŠ¤ç…§ï¼‰

åˆ›å»ºä¸€ä¸ªä¸“é—¨å¤„ç†JWTçš„æœåŠ¡ç±»ã€‚

::: {.callout-tip}
## ğŸ¤– AI Prompt
"åˆ›å»ºä¸€ä¸ª `JwtService` ç±»ï¼Œä½¿ç”¨ `jjwt` åº“ã€‚
åŠŸèƒ½è¦æ±‚ï¼š

1. `generateToken(username)`: ç”ŸæˆTokenï¼Œæœ‰æ•ˆæœŸ24å°æ—¶ã€‚
2. `extractUsername(token)`: ä»Tokenæå–ç”¨æˆ·åã€‚
3. `isTokenValid(token, username)`: éªŒè¯Tokenæœ‰æ•ˆæ€§ã€‚
æ³¨æ„ï¼šä½¿ç”¨ `@Value` æ³¨å…¥å¯†é’¥ï¼Œä¸è¦ç¡¬ç¼–ç ã€‚"
:::

### ä»£ç è¦ç‚¹

*   **å¯†é’¥ç®¡ç†**ï¼šä½¿ç”¨`@Value`ä»é…ç½®æ–‡ä»¶è¯»å–ã€‚ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆå¦‚AWS Secrets Managerï¼‰ã€‚
*   **å¯†é’¥é•¿åº¦**ï¼šHS256ç®—æ³•è¦æ±‚å¯†é’¥è‡³å°‘256ä½ï¼ˆ32å­—èŠ‚ï¼‰ã€‚ç¤ºä¾‹å¯†é’¥é•¿åº¦è¶³å¤Ÿï¼Œä½†çœŸå®é¡¹ç›®åº”ä½¿ç”¨éšæœºç”Ÿæˆçš„å¼ºå¯†é’¥ã€‚
*   **è¿‡æœŸæœºåˆ¶**ï¼šè®¾ç½®24å°æ—¶æœ‰æ•ˆæœŸï¼Œè¿‡æœŸåTokenè‡ªåŠ¨å¤±æ•ˆã€‚
*   **å¼‚å¸¸å¤„ç†**ï¼šä»»ä½•è§£æå¼‚å¸¸ï¼ˆç­¾åä¸åŒ¹é…ã€æ ¼å¼é”™è¯¯ã€å·²è¿‡æœŸï¼‰éƒ½è¿”å›`false`ã€‚

---

## ç¬¬ä¸‰æ­¥ï¼šå®ç°JwtAuthenticationFilterï¼ˆå®‰æ£€å‘˜ï¼‰

ç°åœ¨æˆ‘ä»¬æœ‰äº†ç­¾å‘å’ŒéªŒè¯Tokençš„èƒ½åŠ›ï¼Œä½†Spring Securityè¿˜ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª**è¿‡æ»¤å™¨ï¼ˆFilterï¼‰**ï¼Œåœ¨æ¯ä¸ªè¯·æ±‚åˆ°è¾¾Controllerä¹‹å‰ï¼Œå…ˆæ£€æŸ¥JWTã€‚

::: {.callout-tip}
## ğŸ¤– AI Prompt
"åˆ›å»ºä¸€ä¸ª `JwtAuthenticationFilter`ï¼Œç»§æ‰¿è‡ª `OncePerRequestFilter`ã€‚
é€»è¾‘å¦‚ä¸‹ï¼š

1. ä»Headerè·å– `Authorization`ã€‚
2. å¦‚æœæ˜¯ `Bearer ` å¼€å¤´ï¼Œæå–Tokenã€‚
3. ä½¿ç”¨ `JwtService` éªŒè¯Tokenã€‚
4. å¦‚æœæœ‰æ•ˆï¼Œåˆ›å»º `UsernamePasswordAuthenticationToken` å¹¶æ”¾å…¥ `SecurityContextHolder`ã€‚"
:::

### è¿‡æ»¤å™¨æ‰§è¡Œæµç¨‹

```{mermaid}
sequenceDiagram
    participant Client as "å®¢æˆ·ç«¯(React)"
    participant Filter as JwtAuthenticationFilter
    participant Service as JwtService
    participant Context as SecurityContext
    participant Controller as API Controller
    
    Client->>Filter: Request + Header "Authorization: Bearer <token>"
    Filter->>Service: extractUsername(token)
    Service-->>Filter: username
    Filter->>Service: isTokenValid(token)
    
    alt Tokenæœ‰æ•ˆ
        Service-->>Filter: true
        Filter->>Context: setAuthentication(User)
        Filter->>Controller: doFilter() (æ”¾è¡Œ)
        Controller-->>Client: 200 OK (Data)
    else Tokenæ— æ•ˆ/è¿‡æœŸ
        Service-->>Filter: false
        Filter->>Controller: doFilter() (æœªè®¤è¯çŠ¶æ€)
        Controller-->>Client: 403 Forbidden
    end
```

**å…³é”®é€»è¾‘**ï¼š

1.  æå–`Authorization: Bearer <token>`
2.  è§£æTokenï¼Œæå–ç”¨æˆ·å
3.  éªŒè¯Tokenï¼ˆç­¾åã€æœ‰æ•ˆæœŸï¼‰
4.  å¦‚æœæœ‰æ•ˆï¼Œåˆ›å»º`Authentication`å¯¹è±¡å¹¶æ”¾å…¥`SecurityContext`
5.  Spring Securityçœ‹åˆ°SecurityContextä¸­æœ‰è®¤è¯å¯¹è±¡ï¼Œå°±è®¤ä¸ºç”¨æˆ·å·²ç™»å½•ï¼Œæ”¾è¡Œè¯·æ±‚

---

## ç¬¬å››æ­¥ï¼šå°†JwtFilteré›†æˆåˆ°Securityé…ç½®

ä¿®æ”¹`SecurityConfig`ï¼Œè®©JWTè¿‡æ»¤å™¨åœ¨Spring Securityçš„è¿‡æ»¤å™¨é“¾ä¸­ç”Ÿæ•ˆã€‚

::: {.callout-tip}
## ğŸ¤– AI Prompt
"ä¿®æ”¹ `SecurityConfig`ï¼š

1. æ³¨å…¥ `JwtAuthenticationFilter`ã€‚
2. ä½¿ç”¨ `.addFilterBefore()` å°†å…¶æ·»åŠ åˆ° `UsernamePasswordAuthenticationFilter` ä¹‹å‰ã€‚"
:::

---

## ç¬¬äº”æ­¥ï¼šå‡çº§ç™»å½•æ¥å£ï¼Œè¿”å›JWT

ä¿®æ”¹`AuthController`çš„`login`æ–¹æ³•ï¼Œè¿”å›çœŸæ­£çš„JWTè€Œéç®€å•å­—ç¬¦ä¸²ã€‚

::: {.callout-tip}
## ğŸ¤– AI Prompt
"ä¿®æ”¹ `AuthController` çš„ `/login` æ¥å£ï¼š

1. æ³¨å…¥ `JwtService`ã€‚
2. è®¤è¯æˆåŠŸåï¼Œè°ƒç”¨ `jwtService.generateToken(username)`ã€‚
3. è¿”å›åŒ…å« Token çš„ JSON å“åº”ã€‚"
:::

---

## ç¬¬å…­æ­¥ï¼šéªŒè¯å®Œæ•´æµç¨‹ï¼ˆVibe Checkï¼‰

### æµ‹è¯•ä¸€ï¼šç™»å½•è·å–Token

```bash
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "vibecoder", "password": "secret123"}'
```

**é¢„æœŸè¾“å‡º**ï¼š
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ2aWJlY29kZXIiLCJpYXQiOjE2OTk5MDAwMDAsImV4cCI6MTY5OTk4NjQwMH0.KziYm9haTvVJ0...",
  "username": "vibecoder"
}
```

**å¤åˆ¶è¿™ä¸ªToken**ï¼Œå¾…ç”¨ã€‚

### æµ‹è¯•äºŒï¼šä¸å¸¦Tokenè®¿é—®å—ä¿æŠ¤èµ„æºï¼ˆåº”è¯¥å¤±è´¥ï¼‰

```bash
curl -X DELETE http://localhost:8080/api/playlists/my-favorites
```

**é¢„æœŸç»“æœ**ï¼š403 Forbidden

### æµ‹è¯•ä¸‰ï¼šæºå¸¦Tokenè®¿é—®å—ä¿æŠ¤èµ„æºï¼ˆåº”è¯¥æˆåŠŸï¼‰

```bash
curl -X GET http://localhost:8080/api/playlists \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

å°†`YOUR_TOKEN_HERE`æ›¿æ¢ä¸ºæµ‹è¯•ä¸€ä¸­è·å–çš„Tokenã€‚

**é¢„æœŸç»“æœ**ï¼š200 OKï¼Œè¿”å›æ’­æ”¾åˆ—è¡¨æ•°æ®ã€‚

**å…³é”®**ï¼šæ³¨æ„Headeræ ¼å¼å¿…é¡»ä¸¥æ ¼ä¸º `Authorization: Bearer <token>`ï¼Œ`Bearer`å’ŒTokenä¹‹é—´æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚

### æµ‹è¯•å››ï¼šä½¿ç”¨ä¼ªé€ çš„Tokenï¼ˆåº”è¯¥å¤±è´¥ï¼‰

```bash
curl -X GET http://localhost:8080/api/playlists \
  -H "Authorization: Bearer fake.token.here"
```

**é¢„æœŸç»“æœ**ï¼š403 Forbiddenï¼ˆå› ä¸ºç­¾åéªŒè¯å¤±è´¥ï¼‰

---

## Vibe Deep Diveï¼šJWTçš„å®‰å…¨è¾¹ç•Œ

### JWTèƒ½é˜²å¾¡ä»€ä¹ˆï¼Ÿ

*   âœ… **CSRFæ”»å‡»**ï¼šTokenåœ¨Headerä¸­ï¼Œæµè§ˆå™¨ä¸ä¼šè‡ªåŠ¨æºå¸¦ã€‚
*   âœ… **SessionåŠ«æŒ**ï¼šæ²¡æœ‰Sessionï¼Œæ— æ³•åŠ«æŒã€‚
*   âœ… **ç¯¡æ”¹æ”»å‡»**ï¼šä»»ä½•å¯¹Payloadçš„ä¿®æ”¹éƒ½ä¼šå¯¼è‡´ç­¾åå¤±æ•ˆã€‚

### JWTä¸èƒ½é˜²å¾¡ä»€ä¹ˆï¼Ÿ

*   âŒ **XSSæ”»å‡»**ï¼šå¦‚æœTokenå­˜å‚¨åœ¨`localStorage`ï¼Œæ¶æ„è„šæœ¬å¯çªƒå–ã€‚
    *   ç¼“è§£ï¼šä½¿ç”¨`httpOnly` Cookieå­˜å‚¨ï¼ˆä½†éœ€é‡æ–°å¯ç”¨CSRFä¿æŠ¤ï¼‰ã€‚
*   âŒ **Tokenæ³„éœ²**ï¼šå¦‚æœTokenåœ¨ç½‘ç»œä¼ è¾“ä¸­è¢«æˆªè·ï¼ˆéœ€HTTPSï¼‰ã€‚
*   âŒ **Tokenæ— æ³•ä¸»åŠ¨å¤±æ•ˆ**ï¼šJWTç”Ÿæˆåï¼Œåœ¨è¿‡æœŸå‰æ— æ³•æ’¤é”€ã€‚
    *   ç¼“è§£ï¼šå®ç°Tokené»‘åå•ï¼ˆéœ€é¢å¤–å­˜å‚¨ï¼‰æˆ–ç¼©çŸ­è¿‡æœŸæ—¶é—´ã€‚

### ç”Ÿäº§ç¯å¢ƒçš„æœ€ä½³å®è·µ

1.  **å¯†é’¥ç®¡ç†**ï¼šä½¿ç”¨å¼ºéšæœºå¯†é’¥ï¼Œå­˜å‚¨åœ¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡ä¸­ï¼Œç»ä¸æäº¤åˆ°Gitã€‚
2.  **HTTPSå¼ºåˆ¶**ï¼šTokenåœ¨HTTPä¼ è¾“ï¼ˆæ˜æ–‡ï¼‰ä¸­å®¹æ˜“è¢«æˆªè·ã€‚
3.  **çŸ­æœŸToken + Refresh Token**ï¼šä¸»Tokenæœ‰æ•ˆæœŸè®¾ä¸º1å°æ—¶ï¼Œé…åˆRefresh Tokenå®ç°é•¿æœŸç™»å½•ã€‚
4.  **æ·»åŠ æ›´å¤šClaims**ï¼šå¦‚`iss`ï¼ˆç­¾å‘è€…ï¼‰ã€`aud`ï¼ˆå—ä¼—ï¼‰å¢å¼ºéªŒè¯ã€‚

---

## Vibe Checkï¼ˆåŠ¨æ‰‹ä¸æ€è€ƒï¼‰

1.  **æ ¸å¿ƒç»ƒä¹ **ï¼š
    *   å®Œæˆä¸Šè¿°å››ä¸ªæµ‹è¯•ï¼Œç¡®ä¿JWTå®Œæ•´æµç¨‹æ­£å¸¸å·¥ä½œã€‚
    *   å°è¯•è§£ç ä½ çš„Tokenï¼ˆè®¿é—® [jwt.io](https://jwt.io/)ï¼Œç²˜è´´Tokenï¼‰ï¼Œè§‚å¯ŸPayloadä¸­çš„å†…å®¹ã€‚

2.  **ç¼–ç ç»ƒä¹ **ï¼š
    *   ä¿®æ”¹`JwtService`ï¼Œä½¿Tokenæœ‰æ•ˆæœŸç¼©çŸ­ä¸º5åˆ†é’Ÿã€‚é‡æ–°ç™»å½•è·å–Tokenï¼Œç­‰å¾…6åˆ†é’Ÿåå†æ¬¡ä½¿ç”¨è¯¥Tokenï¼ŒéªŒè¯æ˜¯å¦è¿”å›403ã€‚
    *   åœ¨`LoginResponse`ä¸­æ·»åŠ `expiresIn`å­—æ®µï¼Œå‘Šè¯‰å‰ç«¯Tokenå°†åœ¨å¤šå°‘ç§’åè¿‡æœŸã€‚

3.  **å®‰å…¨æ€è€ƒ**ï¼š
    *   ä¸ºä»€ä¹ˆJWTä¸é€‚åˆå­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ä¿¡ç”¨å¡å·ï¼‰ï¼Ÿ
    *   å¦‚æœç”¨æˆ·ä¿®æ”¹äº†å¯†ç ï¼Œæ—§çš„JWTä»ç„¶æœ‰æ•ˆï¼ˆç›´åˆ°è¿‡æœŸï¼‰ã€‚è¿™æ˜¯å¦æ˜¯å®‰å…¨éšæ‚£ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ

4.  **AIååŒ**ï¼š
    
    > "è¯·è§£é‡ŠHS256å’ŒRS256ä¸¤ç§JWTç­¾åç®—æ³•çš„åŒºåˆ«ã€‚ä»€ä¹ˆåœºæ™¯ä¸‹åº”è¯¥ç”¨RS256ï¼Ÿ"
    
    > "è¯·è§£é‡ŠRefresh Tokenæœºåˆ¶ã€‚å¦‚æœä¸»Tokenæœ‰æ•ˆæœŸ1å°æ—¶ï¼ŒRefresh Tokenæœ‰æ•ˆæœŸ7å¤©ï¼Œå®Œæ•´çš„åˆ·æ–°æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"

---

**æ­å–œï¼** ä½ çš„åº”ç”¨ç°åœ¨æ‹¥æœ‰äº†ä¸€å¥—å®Œæ•´çš„æ— çŠ¶æ€è®¤è¯ä½“ç³»ã€‚ç”¨æˆ·ç™»å½•ä¸€æ¬¡ï¼Œå°±èƒ½è·å¾—24å°æ—¶çš„"å…æ£€é€šè¡Œè¯"ã€‚ä½†æ˜¯ï¼Œ"èƒ½è¿›é—¨"ä¸ä»£è¡¨"èƒ½åˆ åˆ«äººä¸œè¥¿"â€”â€”ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†å®ç°ç»†ç²’åº¦çš„**æˆæƒæ§åˆ¶**ã€‚
