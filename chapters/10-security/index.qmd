# 第十章：构建安全堡垒：全栈安全五部曲

> "你的，才是你的。不是你的，你不能碰。" —— 安全的第一法则

## 本章危机：裸奔的系统

打开你第八章完成的代码。虽然它功能完善，但它有一个致命的缺陷：**它是完全开放的**。
想象一下，你把家里的钥匙挂在门把手上，然后去上班了。这就是我们现在的系统。

*   **匿名危机**: 谁在敲门？不知道。
*   **越界危机**: 张三可以随意把李四的歌单删得干干净净。
*   **失忆危机**: 即使你问了他是谁，下一秒你就忘了。

## 全栈安全五部曲

本章将打破传统的“后端自嗨”模式，带你完成一次真正的**全栈安全闭环**：

- **10.1 守门人 (The Gatekeeper)**: 使用 AI 托管配置，5分钟内锁住所有的门。
- **10.2 身份 (The Identity)**: 建立用户档案，并开启**登录入口**。
- **10.3 护照 (The Passport)**: 引入 JWT，让用户拥有“数字护照”。
- **10.4 规矩 (The Rules)**: 用业务语言定义权限（“只有主人能删歌单”）。
- **10.5 握手 (The Handshake)**: **[重磅]** 回到前端，实现登录页面，打通全栈任督二脉。

::: {.callout-tip}
## 🛡️ Vibe Security 宣言
在本章中，我们将采用 **"AI 托管配置"** 的策略。
安全配置非常繁琐且容易出错，我们将学习如何指挥 AI 生成标准的配置代码，而我们自己则专注于制定**安全策略**。
:::

::: {.callout-note}
## 🛠️ 工具链升级：Context7 MCP 与 现代编辑器
Spring Security 的版本迭代极快（例如从 5.x 到 6.x 的巨大破坏性变更），而通用 LLM 的训练数据往往滞后（常生成已废弃的 `WebSecurityConfigurerAdapter`）。

为了确保 AI 生成的代码是**最新且可用**的，强烈建议升级你的工具链：

1.  **使用 [Context7 MCP](https://github.com/upstash/context7)**:
    *   这是一个为 LLM 提供实时文档的工具。
    *   在 Prompt 中加上 `use context7`，它会自动拉取最新的 Spring Security 官方文档，彻底解决“幻觉”问题。
    *   *例子*: "配置 Spring Security 6.1 的 SecurityFilterChain。 use context7"

2.  **使用现代 AI 编辑器**:
    *   **Cursor** / **Trae**: 这些编辑器原生集成了 MCP 和上下文感知能力。
    *   它们能读取你的 `pom.xml`，知道你用的是 Spring Boot 3.x，从而避免生成 2.x 的旧代码。
:::
