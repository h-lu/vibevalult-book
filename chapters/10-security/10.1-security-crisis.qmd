# 10.1 å®ˆé—¨äººï¼šAI æ‰˜ç®¡çš„å®‰å…¨é…ç½®

åœ¨è§£å†³â€œè°èƒ½è¿›â€çš„é—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦è§£å†³â€œæ€ä¹ˆæ‹¦â€çš„é—®é¢˜ã€‚
Spring Security æ˜¯ Java ä¸–ç•Œæœ€å¼ºå¤§çš„å®ˆé—¨äººï¼Œä½†å®ƒçš„é…ç½®ä¹‹å¤æ‚ä¹Ÿæ˜¯å‡ºäº†åçš„ã€‚

**Vibe Coding ç­–ç•¥**ï¼šä¸è¦è¯•å›¾å»è®°å¿†é‚£äº›æ™¦æ¶©çš„ Filter é“¾é…ç½®ã€‚æŠŠé’¥åŒ™äº¤ç»™ AIã€‚

## ç¬¬ä¸€æ­¥ï¼šå¼•å…¥ä¾èµ–

åœ¨ `gradle/libs.versions.toml` çš„ `[libraries]` åŒºåŸŸæ·»åŠ ï¼š

```toml
spring-boot-starter-security = { module = "org.springframework.boot:spring-boot-starter-security" }
```

ç„¶ååœ¨ `build.gradle.kts` çš„ `dependencies` å—ä¸­æ·»åŠ ï¼š

```kotlin
implementation(libs.spring.boot.starter.security)
```

å½“ä½ é‡å¯åº”ç”¨åï¼Œä½ ä¼šå‘ç°ï¼š**æ‰€æœ‰æ¥å£éƒ½è®¿é—®ä¸äº†äº†**ã€‚
è¿™æ˜¯ Spring Security çš„é»˜è®¤è¡Œä¸ºï¼š**å®å¯é”™æ€ä¸‰åƒï¼Œç»ä¸æ”¾è¿‡ä¸€ä¸ª**ã€‚

## ç¬¬äºŒæ­¥ï¼šAI æ‰˜ç®¡é…ç½® (AI-Managed Configuration)

æˆ‘ä»¬éœ€è¦å‘Šè¯‰å®ˆé—¨äººæˆ‘ä»¬çš„è§„åˆ™ã€‚

**æˆ‘ä»¬çš„è§„åˆ™**ï¼š

1.  **æ— çŠ¶æ€**: æˆ‘ä»¬åšçš„æ˜¯ REST APIï¼Œä¸éœ€è¦ Sessionã€‚
2.  **ç™½åå•**: ç™»å½•ã€æ³¨å†Œæ¥å£ (`/api/auth/**`) å…è®¸æ‰€æœ‰äººè®¿é—®ã€‚
3.  **é»˜è®¤æ‹’ç»**: å…¶ä»–æ‰€æœ‰æ¥å£ï¼Œå¿…é¡»æœ‰â€œé€šè¡Œè¯â€æ‰èƒ½è¿›ã€‚

å¤åˆ¶ä»¥ä¸‹ Prompt ç»™ AIï¼š

::: {.callout-tip}
## ğŸ¤– AI Prompt
"æˆ‘æ­£åœ¨ä½¿ç”¨ Spring Boot 3 å’Œ Spring Securityã€‚
è¯·å¸®æˆ‘ç”Ÿæˆä¸€ä¸ª `SecurityConfig` é…ç½®ç±»ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š

1.  **æ— çŠ¶æ€ (Stateless)**: ç¦ç”¨ CSRFï¼ŒSession ç­–ç•¥è®¾ä¸º `STATELESS`ã€‚
2.  **ç™½åå•**: å…è®¸ `/api/auth/**` (ç™»å½•æ³¨å†Œ) å’Œ `/api/playlists` (GETè¯·æ±‚) åŒ¿åè®¿é—®ã€‚
3.  **é»˜è®¤æ‹’ç»**: å…¶ä»–æ‰€æœ‰è¯·æ±‚å¿…é¡»è®¤è¯ (authenticated)ã€‚
4.  **è¾“å‡º**: è¯·ç›´æ¥ç»™å‡º `SecurityFilterChain` çš„ Bean ä»£ç ã€‚"
:::

::: {.callout-note}
## ğŸ’¡ Vibe Deep Dive: é‚£äº›éš¾æ‡‚çš„é»‘è¯
*   **CSRF (è·¨ç«™è¯·æ±‚ä¼ªé€ )**: 
    *   *æ¯”å–»*: åäººå·äº†ä½ çš„é¥¼å¹² (Cookie)ï¼Œå†’å……ä½ å»é“¶è¡Œå–é’±ã€‚
    *   *ä¸ºä»€ä¹ˆç¦ç”¨*: å› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯ Token (æ”¾åœ¨ Header é‡Œ)ï¼Œè€Œä¸æ˜¯ Cookieã€‚åäººå·ä¸åˆ° Headerï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦é˜² Cookie è¢«å·ã€‚
*   **Stateless (æ— çŠ¶æ€)**:
    *   *æ¯”å–»*: æ¯æ¬¡è¿›é—¨éƒ½è¦æŸ¥èº«ä»½è¯ï¼Œä¿å®‰ä¸è®°è„¸ã€‚
    *   *å¥½å¤„*: æœåŠ¡å™¨ä¸ç”¨æ­»è®°ç¡¬èƒŒè°ç™»å½•äº†ï¼Œçœå†…å­˜ï¼Œè€Œä¸”æ–¹ä¾¿æ‰©å±•ï¼ˆåŠ æœåŠ¡å™¨ï¼‰ã€‚
:::

## ç¬¬ä¸‰æ­¥ï¼šå®¡æŸ¥ AI çš„ä½œä¸š

AI ç”Ÿæˆçš„ä»£ç åº”è¯¥åŒ…å«ä»¥ä¸‹å…³é”®è¯ï¼Œè¯·æ£€æŸ¥ï¼š

*   âœ… `.csrf(csrf -> csrf.disable())` (ç¦ç”¨ CSRF)
*   âœ… `.sessionManagement(...)` (æ— çŠ¶æ€)
*   âœ… `.requestMatchers(...).permitAll()` (ç™½åå•)
*   âœ… `.anyRequest().authenticated()` (é»˜è®¤æ‹’ç»)

æŠŠä»£ç å¤åˆ¶åˆ° `com.vibevault.config.SecurityConfig` ä¸­ã€‚

## Vibe Check

å°è¯•è®¿é—® `GET /api/playlists`ã€‚
*   **é¢„æœŸ**: 200 OK (å› ä¸ºæˆ‘ä»¬åŠ äº†ç™½åå•)ã€‚
å°è¯•è®¿é—® `DELETE /api/playlists/1`ã€‚
*   **é¢„æœŸ**: 403 Forbidden (å› ä¸ºé»˜è®¤æ‹’ç»)ã€‚

å®ˆé—¨äººå·²ç»å°±ä½ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦ç»™å¥½äººå‘èº«ä»½è¯ã€‚
